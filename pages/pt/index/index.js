var t=require("../../../api.js"),a=getApp();Page({data:{cid:0,scrollLeft:600,scrollTop:0,emptyGoods:0,page_count:0,pt_url:!1,page:1,is_show:0,quick_icon:!0},onLoad:function(o){this.systemInfo=wx.getSystemInfoSync(),a.pageOnLoad(this);var e=wx.getStorageSync("store");this.setData({store:e});var n=this;if(o.cid){var i=o.cid;return console.log("cid=>"+i),this.setData({pt_url:!1}),wx.showLoading({title:"正在加载",mask:!0}),void a.request({url:t.group.index,method:"get",success:function(t){n.switchNav({currentTarget:{dataset:{id:o.cid}}}),0==t.code&&n.setData({banner:t.data.banner,ad:t.data.ad,page:t.data.goods.page,page_count:t.data.goods.page_count})}})}this.setData({pt_url:!0}),this.loadIndexInfo(this)},onReady:function(){},quickNavigation:function(){this.setData({quick_icon:!this.data.quick_icon});var t=this.data.store,a=wx.createAnimation({duration:300,timingFunction:"ease-out"}),o=wx.createAnimation({duration:300,timingFunction:"ease-out"}),e=wx.createAnimation({duration:300,timingFunction:"ease-out"}),n=wx.createAnimation({duration:300,timingFunction:"ease-out"}),i=wx.createAnimation({duration:300,timingFunction:"ease-out"}),s=-55;this.data.quick_icon?(a.opacity(0).step(),e.opacity(0).step(),o.opacity(0).step(),n.opacity(0).step(),i.opacity(0).step()):(t.option&&t.option.wxapp&&t.option.wxapp.pic_url&&(i.translateY(s).opacity(1).step(),s-=55),t.show_customer_service&&1==t.show_customer_service&&t.service&&(n.translateY(s).opacity(1).step(),s-=55),t.option&&t.option.web_service&&(e.translateY(s).opacity(1).step(),s-=55),1==t.dial&&t.dial_pic&&(o.translateY(s).opacity(1).step(),s-=55),a.translateY(s).opacity(1).step()),this.setData({animationPlus:a.export(),animationPic:o.export(),animationcollect:e.export(),animationTranspond:n.export(),animationInput:i.export()})},onShow:function(){a.pageOnShow(this)},onHide:function(){},onUnload:function(){},onPullDownRefresh:function(){},onReachBottom:function(){var t=this;t.data.page<t.data.page_count?(t.setData({page:t.data.page+1}),t.getGoods(t)):t.setData({is_show:1})},onShareAppMessage:function(){},loadIndexInfo:function(o){var e=o;wx.showLoading({title:"正在加载",mask:!0}),a.request({url:t.group.index,method:"get",data:{page:e.data.page},success:function(t){0==t.code&&(wx.hideLoading(),e.setData({cat:t.data.cat,banner:t.data.banner,ad:t.data.ad,goods:t.data.goods.list,page:t.data.goods.page,page_count:t.data.goods.page_count}),t.data.goods.row_count<=0&&e.setData({emptyGoods:1}))}})},getGoods:function(o){var e=o;wx.showLoading({title:"正在加载",mask:!0}),a.request({url:t.group.list,method:"get",data:{page:e.data.page},success:function(t){0==t.code&&(wx.hideLoading(),e.data.goods=e.data.goods.concat(t.data.list),e.setData({goods:e.data.goods,page:t.data.page,page_count:t.data.page_count}))}})},switchNav:function(o){var e=this;wx.showLoading({title:"正在加载",mask:!0});var n=0;if(n!=o.currentTarget.dataset.id||0==o.currentTarget.dataset.id){n=o.currentTarget.dataset.id;var i=this.systemInfo.windowWidth,s=o.currentTarget.offsetLeft,d=this.data.scrollLeft;d=s>i/2?s:0,e.setData({cid:n,page:1,scrollLeft:d,scrollTop:0,emptyGoods:0,goods:[],show_loading_bar:1,is_show:0}),a.request({url:t.group.list,method:"get",data:{cid:n},success:function(t){if(0==t.code){setTimeout(function(){wx.hideLoading()},1e3);var a=t.data.list;t.data.page_count>=t.data.page?e.setData({goods:a,page:t.data.page,page_count:t.data.page_count,row_count:t.data.row_count,show_loading_bar:0}):e.setData({emptyGoods:1})}}})}},pullDownLoading:function(o){var e=this;if(1!=e.data.emptyGoods&&1!=e.data.show_loading_bar){e.setData({show_loading_bar:1});var n=parseInt(e.data.page+1),i=e.data.cid;a.request({url:t.group.list,method:"get",data:{page:n,cid:i},success:function(t){if(0==t.code){var a=e.data.goods;t.data.page>e.data.page&&Array.prototype.push.apply(a,t.data.list),t.data.page_count>=t.data.page?e.setData({goods:a,page:t.data.page,page_count:t.data.page_count,row_count:t.data.row_count,show_loading_bar:0}):e.setData({emptyGoods:1})}}})}},navigatorClick:function(t){var a=t.currentTarget.dataset.open_type,o=t.currentTarget.dataset.url;return"wxapp"!=a||(o=function(t){var a=/([^&=]+)=([\w\W]*?)(&|$|#)/g,o=/^[^\?]+\?([\w\W]+)$/.exec(t),e={};if(o&&o[1])for(var n,i=o[1];null!=(n=a.exec(i));)e[n[1]]=n[2];return e}(o),o.path=o.path?decodeURIComponent(o.path):"",wx.navigateToMiniProgram({appId:o.appId,path:o.path,complete:function(t){}}),!1)},to_dial:function(){var t=this.data.store.contact_tel;wx.makePhoneCall({phoneNumber:t})}}); 
 			